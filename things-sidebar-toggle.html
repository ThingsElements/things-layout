<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-tooltip/paper-tooltip.html">

<link rel="import" href="../things-global-behavior/things-global-behavior.html">
<link rel="import" href="../things-i18n-msg/things-i18n-msg.html">

<!--
  Toggle Sidebar Toggle
-->

<dom-module id="things-sidebar-toggle">
  <template>
    <style>
      :host {
        display: block;
      }
      paper-button {
        /*background:url(/images/icon-brand.png) no-repeat transparent;*/
        @apply(--things-brand-btn);
        background-size:45px 45px !important;
      }
    </style>

    <!-- menu toggle -->
    <paper-button id="sidebar-toggler" style$="background:url({{imageUrl}}) no-repeat transparent;"></paper-button>

    <paper-tooltip for="sidebar-toggler">
      <things-i18n-msg msgid="button.toggle_sidebar" auto>Toggle Sidebar</things-i18n-msg>
    </paper-tooltip>
  </template>

  <script>
    Polymer({
      is: 'things-sidebar-toggle',

      behaviors: [
        Things.GlobalBehavior
      ],

      properties: {
        /**
         * drawer 아이다
         * ******
         * @type {String}
         */
        drawerId: {
          type: String
        },

        /**
         * brand image 아이디
         * ******
         * @type {String}
         */
        brandImageId: {
          type: String
        },

        /**
         * brand image
         * *******
         * @type {sTRING}
         */
        imageUrl: {
          type: String,
          value: '/images/icon-brand.png',
          computed: '_computeImageUrl(brandImageId)'
        }
      },

      listeners: {
        'sidebar-toggler.tap': 'toggleSidebar'
      },

      /**
       * brandImageId가 변경되었을 경우
       ********
       * @param {String} brandImageId
       */
      _computeImageUrl: function(brandImageId) {
        var baseUrl = this.get('globals.baseUrl');
        return baseUrl + '/download/' + brandImageId;
      },

      /**
       * Toggle Sidebar. 로그인 이후에만 toggle이 적용됨
       * **********
       */
      toggleSidebar: function(e) {
        var drawer = app.$[this.drawerId];

        if(drawer.forceNarrow) {
          drawer.forceNarrow = false
        } else if(!drawer.narrow) {
          drawer.forceNarrow = true
        } else {
          drawer.togglePanel();
        }
      }
    });
  </script>
</dom-module>
